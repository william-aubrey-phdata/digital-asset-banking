
### 5.2. Analytics Data Model (Snowflake)

All transactional and metadata will be stored in a Snowflake data warehouse using a star schema for optimized analytics.

**DDL Script:**

```sql
-- Dimension for Asset Types
CREATE OR REPLACE TABLE DIM_ASSET_TYPES (
    ASSET_TYPE_SK   NUMBER(38,0) IDENTITY PRIMARY KEY,
    ASSET_TYPE_NAME VARCHAR(50) UNIQUE NOT NULL
);

-- Dimension for Users
CREATE OR REPLACE TABLE DIM_USERS (
    USER_SK NUMBER(38,0) IDENTITY PRIMARY KEY,
    USER_NK VARCHAR(255) UNIQUE NOT NULL
);

-- Dimension for Assets
CREATE OR REPLACE TABLE DIM_ASSETS (
    ASSET_SK                NUMBER(38,0) IDENTITY PRIMARY KEY,
    S3_KEY                  VARCHAR(1024) UNIQUE NOT NULL,
    ASSET_NAME              VARCHAR(255) NOT NULL,
    ASSET_TYPE_SK           NUMBER(38,0) NOT NULL FOREIGN KEY REFERENCES DIM_ASSET_TYPES(ASSET_TYPE_SK),
    CURRENT_OWNER_USER_SK   NUMBER(38,0) FOREIGN KEY REFERENCES DIM_USERS(USER_SK),
    GRAPH_ROLE              VARCHAR(50),
    UPLOAD_TIMESTAMP        TIMESTAMP_NTZ NOT NULL
);

-- Fact table for all transactions
CREATE OR REPLACE TABLE FCT_ASSET_TRANSACTIONS (
    TRANSACTION_PK        NUMBER(38,0) IDENTITY PRIMARY KEY,
    ASSET_SK              NUMBER(38,0) NOT NULL FOREIGN KEY REFERENCES DIM_ASSETS(ASSET_SK),
    BUYER_USER_SK         NUMBER(38,0) FOREIGN KEY REFERENCES DIM_USERS(USER_SK),
    TRANSACTION_TYPE      VARCHAR(50) NOT NULL,
    CREDITS_SPENT         NUMBER(38,0),
    TRANSACTION_TIMESTAMP TIMESTAMP_NTZ NOT NULL
);
```

---